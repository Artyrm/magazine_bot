@echo off
:: –í–∫–ª—é—á–∞–µ–º –ø–æ–¥–¥–µ—Ä–∂–∫—É UTF-8 –≤ –∫–æ–Ω—Å–æ–ª–∏
chcp 65001 > nul
cls

:: --- –ë–õ–û–ö 1: –ü–†–û–í–ï–†–ö–ê –ü–†–ê–í –ê–î–ú–ò–ù–ò–°–¢–†–ê–¢–û–†–ê ---
:: –ü—ã—Ç–∞–µ–º—Å—è –≤—ã–ø–æ–ª–Ω–∏—Ç—å –∫–æ–º–∞–Ω–¥—É, —Ç—Ä–µ–±—É—é—â—É—é –∞–¥–º–∏–Ω—Å–∫–∏—Ö –ø—Ä–∞–≤
net session >nul 2>&1
if %errorLevel% == 0 (
    goto :admin_ok
) else (
    echo.
    echo üîí –ó–∞–ø—Ä–æ—Å –ø—Ä–∞–≤ –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞...
    :: –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ–º —ç—Ç–æ—Ç –∂–µ –±–∞—Ç–Ω–∏–∫ —á–µ—Ä–µ–∑ PowerShell —Å —Ñ–ª–∞–≥–æ–º RunAs
    powershell -Command "Start-Process '%~f0' -Verb RunAs"
    exit
)

:admin_ok
:: --- –ë–õ–û–ö 2: –ü–ï–†–ï–ó–ê–ì–†–£–ó–ö–ê –ë–û–¢–ê ---
cd /d "%~dp0"
echo.
echo ==========================================
echo    üîÑ –ü–ï–†–ï–ó–ê–ì–†–£–ó–ö–ê –ë–û–¢–ê (MagazineBot)
echo ==========================================
echo.

echo [1/3] üõë –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å–ª—É–∂–±—É...
nssm stop MagazineBot

:: –ù—é–∞–Ω—Å: –¥–∞–µ–º Windows 3 —Å–µ–∫—É–Ω–¥—ã, —á—Ç–æ–±—ã –ø—Ä–æ—Ü–µ—Å—Å Python —Ç–æ—á–Ω–æ —É–º–µ—Ä
echo.
echo [2/3] ‚è≥ –û–∂–∏–¥–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ (3 —Å–µ–∫)...
timeout /t 3 /nobreak > nul

echo.
echo [3/3] üöÄ –ó–∞–ø—É—Å–∫–∞–µ–º —Å–ª—É–∂–±—É...
nssm start MagazineBot

echo.
echo ==========================================
echo    üìä –¢–ï–ö–£–©–ò–ô –°–¢–ê–¢–£–°:
echo ==========================================
nssm status MagazineBot

echo.
echo –ì–æ—Ç–æ–≤–æ. –û–∫–Ω–æ –º–æ–∂–Ω–æ –∑–∞–∫—Ä—ã–≤–∞—Ç—å.
pause