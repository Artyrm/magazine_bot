# fsm_config.yaml

initial_state: main_menu

states:
  # --- –ì–õ–ê–í–ù–û–ï –ú–ï–ù–Æ ---
  main_menu:
    text: |
      ü§ñ <b>–ñ—É—Ä–Ω–∞–ª ¬´–Æ–Ω—ã–π –∫–∏–±–µ—Ä—Ñ–∏–∑–∏–∫¬ª</b>
      –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤—É–µ–º! –ú—ã –ø–∏—à–µ–º –ø—Ä–æ —Ä–æ–±–æ—Ç–æ–≤, –¥—Ä–æ–Ω—ã –∏ –±—É–¥—É—â–µ–µ.
      
      –í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ:
    keyboard:
      - ["‚úçÔ∏è –û—Ñ–æ—Ä–º–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É"]
      - ["üìñ –û –∂—É—Ä–Ω–∞–ª–µ", "üåê –ö–æ–Ω—Ç–∞–∫—Ç—ã"]
    transitions:
      - trigger: "‚úçÔ∏è –û—Ñ–æ—Ä–º–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É"
        dest: input_name
      - trigger: "üìñ –û –∂—É—Ä–Ω–∞–ª–µ"
        dest: show_about
      - trigger: "üåê –ö–æ–Ω—Ç–∞–∫—Ç—ã"
        dest: show_contacts

  # --- –ò–ù–§–û–†–ú–ê–¶–ò–Ø ---
  show_about:
    text: |
      <b>–û –Ω–∞—Å:</b>
      –≠—Ç–æ –∏–∑–¥–∞–Ω–∏–µ –¥–ª—è —Ç–µ—Ö, –∫—Ç–æ —Å—Ç—Ä–æ–∏—Ç –±—É–¥—É—â–µ–µ!
      üîπ –†–æ–±–æ—Ç–æ—Ç–µ—Ö–Ω–∏–∫–∞ –∏ —ç–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∞
      üîπ –ü—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ –¥—Ä–æ–Ω–æ–≤
      üîπ –ü—Ä–æ–µ–∫—Ç—ã –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã ¬´–ë–µ—Ä–ª–æ–≥–∞¬ª
      üîπ –ö–æ—Ç–µ–ª—å–Ω—ã–µ –Ω–∞ –æ—Å—Ç—Ä–æ–≤–∞—Ö (—Ö–æ—Ç—å –∏–º –∏ –Ω–µ –¥–∞—é—Ç –ø–µ—á–∞—Ç–∞—Ç—å—Å—è)
    keyboard:
      - ["üîô –ù–∞–∑–∞–¥"]
    transitions:
      - trigger: "üîô –ù–∞–∑–∞–¥"
        dest: main_menu

  show_contacts:
    text: |
      <b>–ù–∞—à–∏ –∫–æ–Ω—Ç–∞–∫—Ç—ã:</b>
      –°–∞–π—Ç: cyber-phys.ru
      Email: info@cyber-phys.ru
    keyboard:
      - ["üîô –ù–∞–∑–∞–¥"]
    transitions:
      - trigger: "üîô –ù–∞–∑–∞–¥"
        dest: main_menu

  # --- –ê–ù–ö–ï–¢–ê ---
  input_name:
    text: "–®–∞–≥ 1/3. –í–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ <b>–§–ò–û</b>:"
    keyboard: 
      - ["‚ùå –û—Ç–º–µ–Ω–∞"]
    transitions:
      - trigger: "‚ùå –û—Ç–º–µ–Ω–∞"
        dest: main_menu
        action: clear_data
      - trigger: "*"   # –õ—é–±–æ–π –¥—Ä—É–≥–æ–π —Ç–µ–∫—Å—Ç
        dest: input_address
        action: save_name

  input_address:
    text: "–®–∞–≥ 2/3. –£–∫–∞–∂–∏—Ç–µ <b>–ø–æ—á—Ç–æ–≤—ã–π –∞–¥—Ä–µ—Å</b> (—Å –∏–Ω–¥–µ–∫—Å–æ–º):"
    keyboard: 
      - ["‚ùå –û—Ç–º–µ–Ω–∞"]
    transitions:
      - trigger: "‚ùå –û—Ç–º–µ–Ω–∞"
        dest: main_menu
        action: clear_data
      - trigger: "*"
        dest: input_phone
        action: save_address

  input_phone:
    text: "–®–∞–≥ 3/3. –í–∞—à –∫–æ–Ω—Ç–∞–∫—Ç–Ω—ã–π <b>—Ç–µ–ª–µ—Ñ–æ–Ω</b>:"
    keyboard: 
      - ["‚ùå –û—Ç–º–µ–Ω–∞"]
    transitions:
      - trigger: "‚ùå –û—Ç–º–µ–Ω–∞"
        dest: main_menu
        action: clear_data
      - trigger: "*"
        dest: confirmation
        action: save_phone

  # --- –ü–û–î–¢–í–ï–†–ñ–î–ï–ù–ò–ï ---
  confirmation:
    text: |
      <b>–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–∞–Ω–Ω—ã–µ:</b>
      
      üë§ <b>–§–ò–û:</b> {name}
      üè† <b>–ê–¥—Ä–µ—Å:</b> {address}
      üì± <b>–¢–µ–ª–µ—Ñ–æ–Ω:</b> {phone}
      
      –í—Å—ë –≤–µ—Ä–Ω–æ?
    keyboard:
      - ["‚úÖ –î–∞, –æ—Ç–ø—Ä–∞–≤–∏—Ç—å", "‚úèÔ∏è –ù–µ—Ç, –∏—Å–ø—Ä–∞–≤–∏—Ç—å"]
      - ["‚ùå –û—Ç–º–µ–Ω–∏—Ç—å"]
    transitions:
      - trigger: "‚úÖ –î–∞, –æ—Ç–ø—Ä–∞–≤–∏—Ç—å"
        dest: finish_success
        action: submit_to_excel
      
      - trigger: "‚úèÔ∏è –ù–µ—Ç, –∏—Å–ø—Ä–∞–≤–∏—Ç—å"
        dest: input_name # –¶–∏–∫–ª: –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –≤ –Ω–∞—á–∞–ª–æ –∞–Ω–∫–µ—Ç—ã
        
      - trigger: "‚ùå –û—Ç–º–µ–Ω–∏—Ç—å"
        dest: main_menu
        action: clear_data

  # --- –§–ò–ù–ê–õ ---
  finish_success:
    text: "‚úÖ <b>–ó–∞—è–≤–∫–∞ –ø—Ä–∏–Ω—è—Ç–∞!</b>\n–°–ø–∞—Å–∏–±–æ, —á—Ç–æ –≤—ã —Å –Ω–∞–º–∏."
    keyboard:
      - ["üîô –í –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é"]
    transitions:
      - trigger: "*"
        dest: main_menu
        action: clear_data